/*! Generated by Clam: test 2014-08-27 19:37:59 */
var Index={userid:function(){if(M.urlQuery("userid"))return parseInt(M.urlQuery("userid"));var a=location.hostname,b=a.split(".");return Number(b[0])},pageNum:0,pageSize:10,locaHref:"<<$url>>",getShopInfo:function(){M.jsonp(M.h5Port+"/H5ShopInfo.php?userid="+Index.userid(),function(a){console.log(a);var b=a.status;if(0==b||1==b){var c=Number(M.getCookie("WD_seller"));if(c!=Index.userid()&&(M.switchCookie(),M.setCookie("WD_seller",Index.userid())),$("#hd_name").html(a.shopName||"YouShop"),$("#vshop_icon").children().eq(0).attr("src",a.logo),$("#hd_bg").css("background-image","url("+a.shopImg+")"),a.note&&($("#hd_bg").html("<em id='hd_bg_em_a' class='abs over_hidden'>&nbsp;</em><em id='hd_bg_em_b' class='abs over_hidden'>&nbsp;</em>"),$("#hd_intro").html(a.note).show()),Number(a.hasItem))switch(a.hasItem){case 1:Index.item_hot();break;case 2:Index.item_top();break;case 3:Index.item_top(),Index.item_hot()}else Index.item_empty();Index.doWeixinShare();var d=a.share_data,e=d[0],f=d[1],g=Number(e.isShow),h=Number(f.isShow);(g||h)&&M.loadScript("http://s.test.youshop.com/ushop/script/index/index_sns.js",function(){$("#showSNSBtn").show(),g&&Index.doFBLike(),h&&Index.Tweet(f.account_name,f.account_link)})}else(2==b||3==b)&&Index.noShop()})},doWeixinShare:function(){M.isWeixin()&&(Index.weixinShareHandle?Index.weixinShare():M.loadScript("http://s.test.youshop.com/ushop/script/index/index_wx_share.js",function(){Index.weixinShareHandle=!0,Index.weixinShare()}))},item_empty:function(){$("#index_loading").hide(),$("#item_empty").show().addClass("item_empty_icon")},item_top:function(){M.jsonp(M.h5Port+"/H5GetTopItems.php?userid="+Index.userid()+"&pageNum=0&pageSize=0",function(a){$("#index_loading").hide();for(var b=a.length,c=$("#top_ul"),d="",e=0;b>e;e++){var f=a[e];d=d+"<li class='i_li left'><a href='"+M.sUrl(Index.userid(),f.itemID,"p=-1")+"'><img src='"+f.img+"' width='137' height='137'><p class='i_txt'>"+f.itemName+"</p><p class='i_pri'>$"+f.price+"</p></a></li>"}c.html(d).parent().show()})},item_hot:function(){var a=Index.pageSize;Index.scrollToHot&&(Index.scrollToHotLoaded||(a=(Number(M.getCookie("WD_viewedPage"))+1)*a)),Index.scroll_loading_txt.removeClass("hide"),$(window).bind("scroll",function(){var a=document.body.scrollTop||document.documentElement.scrollTop;if(M.setCookie("WD_scrollToViewed",a,!0),Index.item_hot_handle&&!Index.scroll_loading){var b=document.documentElement.clientHeight,c=document.body.offsetHeight;if(a>Index.max_top){Index.max_top=a;var d=b+a+600;d>=c&&Index.item_hot_handle&&Index.item_hot()}}}),Index.item_hot_handle&&!Index.scroll_loading&&(Index.scroll_loading=!0,M.jsonp(M.h5Port+"/H5GetCommonItems.php?userid="+Index.userid()+"&pageNum="+Index.pageNum+"&pageSize="+a,function(a){Index.scroll_loading=!1,$("#index_loading").hide();var b=a.data.length,c=$("#hot_ul"),d="";if(Index.scrollToHot&&!Index.scrollToHotLoaded&&Number(M.getCookie("WD_viewedPage")))for(var e=0;b>e;e++){var f=a.data[e];d=d+"<li class='i_li left'><a href='"+M.sUrl(Index.userid(),f.itemID,"p="+Math.floor(e/Index.pageSize))+"'><img src='"+f.img+"' width='137' height='137'><p class='i_txt'>"+f.itemName+"</p><p class='i_pri'>"+a.currencySign+f.price+"</p></a></li>"}else for(var e=0;b>e;e++){var f=a.data[e];d=d+"<li class='i_li left'><a href='"+M.sUrl(Index.userid(),f.itemID,"p="+Index.pageNum)+"'><img src='"+f.img+"' width='137' height='137'><p class='i_txt'>"+f.itemName+"</p><p class='i_pri'>"+a.currencySign+f.price+"</p></a></li>"}c.append(d).parent().show(),0==Index.pageNum&&(Index.scrollToTop?setTimeout(function(){window.scroll(0,M.getCookie("WD_scrollToViewed")),M.setCookie("WD_viewedPage",-1,!0),M.setCookie("WD_scrollToViewed",0,!0)},200):Index.scrollToHot&&(Index.scrollToHotLoaded=!0,Index.pageNum=Number(M.getCookie("WD_viewedPage")),setTimeout(function(){window.scroll(0,M.getCookie("WD_scrollToViewed")),M.setCookie("WD_viewedPage",-1,!0),M.setCookie("WD_scrollToViewed",0,!0)},200))),$("#cart").attr("href",M.baseUrl+"/cart.html?p="+Index.pageNum),Index.pageNum++,b<Index.pageSize&&(Index.scroll_loading_txt.html("&nbsp;"),Index.item_hot_handle=!1,$(window).unbind("scroll"))}))},item_hot_handle:!0,scroll_loading:!1,max_top:0,scroll_loading_txt:$("#scroll_loading_txt"),noShop:function(){$("#wd_show").hide(),$("#noShop").show(),$("#noShopShow").addClass("noShopShow_icon")},scrollToTop:!1,scrollToHot:!1,scrollToHotLoaded:!1,weixinShareHandle:!1,init:function(){this.renderUi(),$("#cart").attr("href",M.baseUrl+"/cart.html"),Index.userid()===Number(M.getCookie("WD_seller"))&&Number(M.getCookie("WD_scrollToViewed"))&&(-1==Number(M.getCookie("WD_viewedPage"))?Index.scrollToTop=!0:Index.scrollToHot=!0),Index.userid()?(Index.getShopInfo(),M.isWeixin()&&(M.loadScript("http://s.test.youshop.com/ushop/script/index/index_wx_share.js",function(){Index.weixinShareHandle=!0}),Number(M.getCookie("WD_close_favor"))||M.loadScript("http://s.test.youshop.com/ushop/script/common/favor_weixin.js",function(){console.log("favor_weixin is loaded")}))):Index.noShop(),setTimeout(function(){M.jsonp(M.h5Port+"/H5TrackVisit.php?buyer_id="+M.getCookie("buyer_id")+"&track_type=1&item_id=&user_id="+Index.userid()+"&guid="+M.getCookie("WD_guid")+"&frid="+M.urlQuery("frid")),M.isMobile()?$("#iWantAShopIndex").attr("href","http://www.youshop.com/weidian_offical_H5_en/?from=iWantIndex"):$("#iWantAShopIndex").attr("href","http://www.youshop.com/weidian_offical_PC_en/?from=iWantIndex")},200)},renderUi:function(){var a=this,b=$("#index_sec"),c=$("#tpl").html(),d=LANG[M.getCookie("Lang")||a.queryLang()],e=$("#tpl-noShop").html(),f=$("#noShop");M.setCookie("Lang",a.queryLang());var g=juicer(c,d);b.html(g),f.html(juicer(e,d)),console.log(LANG[a.queryLang()]),this.scroll_loading_txt=$("#scroll_loading_txt")},queryLang:function(){var a=navigator.language.toLowerCase();return a in LANG&&"zh-cn"!=a?a:"en-us"}};Index.init();